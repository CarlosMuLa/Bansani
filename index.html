<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bansani</title>
    <style>
        .categories {
            display: flex;
            flex-wrap: wrap;
            gap: 40px;
        }
        .category {
            flex: 1 1 300px;
            min-width: 300px;
        }
        fieldset {
            border: none;
            padding: 0;
            margin: 0;
        }
        label {
            display: block;
            margin-bottom: 0;
        }

        /* ==== NUEVOS ESTILOS ECO PARA LAS PREGUNTAS ==== */

        body {
            background: #f2f1eb; /* Color crema del logo */
            font-family: system-ui, Arial, sans-serif;
            color: #5d6b5a; /* Verde oscuro para texto legible */
        }

        h1 {
            font-size:28px;
            font-weight:700;
            margin:28px 0 30px;
            text-align:center;
            color:#385898;
            letter-spacing:.5px;
        }

        .categories {
            align-items:flex-start;
        }

        .categories details {
            background:#ffffff;
            border:1px solid #e0e0d6;
            border-radius:18px;
            padding:0;
            box-shadow:0 3px 8px -3px rgba(0,0,0,.08);
            transition:.35s;
            position:relative;
        }
        .categories details:hover {
            box-shadow:0 6px 16px -4px rgba(0,0,0,.12);
        }

        .categories details summary {
            list-style:none;
            cursor:pointer;
            font-size:17px;
            font-weight:600;
            padding:16px 56px 16px 20px;
            border-radius:18px;
            background:#385898;
            color:#fff;
            position:relative;
            user-select:none;
        }
        .categories details summary::-webkit-details-marker { display:none; }

        .categories details summary::before {
            content: "S";
            font-family: serif;
            font-style: italic;
            font-weight: bold;
            color: #7A8A76;
            margin-right: 8px;
            filter: drop-shadow(0 1px 2px rgba(0,0,0,.25));
        }
        .categories details summary::after {
            content:"";
            position:absolute;
            top:50%;
            right:18px;
            width:12px;
            height:12px;
            border:2px solid #fff;
            border-left:0;
            border-top:0;
            transform:translateY(-60%) rotate(45deg);
            transition:.35s;
        }
        .categories details[open] summary::after {
            transform:translateY(-40%) rotate(225deg);
        }
        .categories details[open] summary {
            border-bottom-left-radius:0;
            border-bottom-right-radius:0;
        }

        .categories details[open] {
            border-color:#385898;
        }

        .categories details > fieldset {
            display:block;
            margin:0 0 0;
            padding:0;
        }

        /* Contenedor interno de preguntas */
        .categories details[open] {
            padding-bottom:10px;
        }

        .categories details[open] fieldset {
            margin:18px 18px 0;
        }

        /* Tarjeta de cada pregunta */
        fieldset.LVL1,
        fieldset.LVL2,
        fieldset.LVL3 {
            background:#ffffff;
            border:1px solid #dce9e1;
            border-left:6px solid #7a8a76;
            border-radius:14px;
            padding:14px 16px 12px;
            position:relative;
            font-size:14px;
            line-height:1.45;
            box-shadow:0 2px 4px rgba(0,0,0,.05);
            transition:.35s;
        }
        fieldset.LVL2 { border-left-color: #5d6b5a; }
        fieldset.LVL3 { border-left-color:#385898; }

        fieldset.LVL1:hover,
        fieldset.LVL2:hover,
        fieldset.LVL3:hover {
            box-shadow:0 4px 12px -2px rgba(0,0,0,.10);
            transform:translateY(-2px);
        }

        fieldset.LVL1 p,
        fieldset.LVL2 p,
        fieldset.LVL3 p {
            margin:0 0 10px;
            font-weight:600;
            color:#385898;
        }

        /* Texto directo (cuando no usan <p>) */
        fieldset.LVL1 > :first-child,
        fieldset.LVL2 > :first-child,
        fieldset.LVL3 > :first-child {
            /* fallback por si es texto suelto */
        }

        /* Opciones */
        fieldset label {
            display:inline-flex;
            align-items:center;
            gap:6px;
            margin:4px 8px 4px 0;
            padding:6px 14px 6px 12px;
            background:#f0f8f3;
            border:1px solid #c6e7d2;
            border-radius:30px;
            font-size:13px;
            font-weight:600;
            letter-spacing:.3px;
            color:#5d6b5a;
            cursor:pointer;
            line-height:1.2;
            transition:.25s;
            user-select:none;
        }
        fieldset label:hover {
            background:#e3f5e8;
            border-color:#b3ddc3;
        }

        fieldset label input[type=radio] {
            accent-color:#385898;
            transform:scale(1.05);
            margin:0 2px 0 0;
        }

        /* Estado seleccionado (usa :has para navegadores modernos) */
        fieldset label:has(input[type=radio]:checked) {
            background:#385898;
            color:#fff;
            border-color:#385898;
            box-shadow:0 0 0 2px #d9dce3;
        }

        /* Fallback sin :has (aún se ve aceptable) */

        /* Animación al abrir */
        .categories details[open] fieldset {
            animation:fadeSlide .45s ease;
        }
        @keyframes fadeSlide {
            from { opacity:0; transform:translateY(6px);}
            to { opacity:1; transform:translateY(0);}
        }

        /* Responsive */
        @media (max-width:900px){
            .categories { gap:28px; }
            .categories details summary { font-size:16px; padding:14px 50px 14px 18px; }
            fieldset.LVL1, fieldset.LVL2, fieldset.LVL3 { font-size:13px; padding:12px 14px 10px; }
            fieldset label { font-size:12px; padding:6px 12px 6px 10px; }
        }
        @media (max-width:600px){
            h1 { font-size:23px; }
            .category { flex:1 1 100%; }
        }

        #client-modal input[type="text"],
        #client-modal input[type="tel"],
        #client-modal input[type="email"] {
            width: 100%;
            padding: 8px;
            margin: 8px 0;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        /* input para el telefono */
        #client-modal button {
            background-color: #385898;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        #client-modal input[type="text"]:focus,
        #client-modal input[type="tel"]:focus,
        #client-modal input[type="email"]:focus {
            border-color: #1846a3;
            outline: none;
        }
        #client-modal label {
            font-weight: 500;
            color: #1846a3;
            display: block;
        }
        #client-modal button[type="submit"] {
            background: #1846a3;
            color: #fff;
            border: none;
            border-radius: 6px;
            padding: 12px 0;
            width: 100%;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 8px;
        }
        #client-modal button[type="submit"]:hover {
            background: #143a85;
        }

    </style>
</head>
<body>

    <div id="client-modal" style="display: none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.3); z-index:1000;">
        <div style="background:#fff; padding:20px; border-radius:8px; width:90%; max-width:400px; margin:100px auto; position:relative;">
            <button id="close-modal-btn" style="position:absolute; top:12px; right:12px; background:none; border:none; font-size:1.5rem; cursor:pointer;">&times;</button>
            <h2>Información del Cliente</h2>
            <form id="client-form">
                <label for="client-name">Nombre:</label>
                <input type="text" id="client-name" name="nombre" required>

                <label for="client-email">Email:</label>
                <input type="email" id="client-email" name="correo" required>

                <label for="client-phone">Teléfono:</label>
                <input type="tel" id="client-phone" name="telefono" required>
                <input type="hidden" name="action" value="send_clientify_contact">
                <input type="hidden" name="nonce" id="nonce-field" value="">

                <button type="submit">Enviar</button>
            </form>
        </div>
    </div>
    <h1>Selecciona de las categorias tus intereses</h1>
    <div class="categories">
        <div class="category">
            <details closed class="Lugar" data-categories="Lugar">
                <summary>Lugar</summary>
                <fieldset class="LVL1" data-services="L.01.1, C.01.2, L.01.3">
                    <p>¿Tiene el objetivo de mejorar la relación entre el proyecto y el contexto inmediato que lo rodea al reducir el impacto ambiental del proyecto?</p> <br>
                    <label><input type="radio" name="Lugar1">SI</label>
                    <label><input type="radio" name="Lugar1" checked>NO</label>
                </fieldset>
                <fieldset class="LVL1" data-services="L.02.1, L.02.2">
Tiene el objetivo de unir zonas naturales importantes, disminuyendo el impacto del proyecto en el espacio. <br>
                    <label>
                        <input type="radio" name="Lugar2">SI</label>
                    <label>
                        <input type="radio" name="Lugar2" checked>NO</label>
                </fieldset>

                <fieldset class="LVL2" data-services="L.03.1, L.03.2">
Tiene el objetivo de mejorar los microclimas mediante la reducción de las islas de calor.     <br>               
                    <label>
                        <input type="radio" name="Lugar3">SI
                    </label>
                    <label>
                        <input type="radio" name="Lugar3" checked>NO
                    </label>
                </fieldset>

                <fieldset class="LVL1" data-services="L.04.1, L.04.2">
Tiene el objetivo de disminuir el consumo energético al iluminar solo necesario, cuando sea necesario con la intensidad necesaria. <br>
                    <label>
                        <input type="radio" name="Lugar4">SI
                    </label>
                    <label>
                        <input type="radio" name="Lugar4" checked>
                        NO
                    </label>
                </fieldset>
                <fieldset class="LVL1" data-services="L.05.1, L.05.2">
Tiene el objetivo de mejorar la calidad del transporte para el personal y así poder garantizar un acceso adecuado al servicio que pueda cumplir con la oferta, demanda y seguridad para que puedan realizar las rutas sin ningún problema. <br>
                    <label>
                        <input type="radio" name="Lugar5">
                        SI
                    </label>
                    <label>
                        <input type="radio" name="Lugar5" checked>
                        NO
                    </label>
                </fieldset>
                <fieldset class="LVL1" data-services="L.06.1, L.06.2">
Tiene el objetivo de analizar la cantidad de estacionamientos con los que cuenta el proyecto y los que requiere para así poder cubrir con lo necesario o disminuir la cantidad con la que se cuenta. <br>
                    <label>
                        <input type="radio" name="Lugar6">
                        SI
                    </label>
                    <label>
                        <input type="radio" name="Lugar6" checked>
                        NO
                    </label>
                </fieldset>
                <fieldset class="LVL1" data-services="L.07.1, L.07.2, L.07.3">
Tiene el objetivo de identificar áreas que se encuentren contaminadas o en mal estado, realizar un trabajo de recuperación para un funcionamiento adecuado. <br>
                    <label>
                        <input type="radio" name="Lugar7">
                        SI
                    </label>
                    <label>
                        <input type="radio" name="Lugar7" checked>
                        NO
                    </label>
                </fieldset>
                <fieldset class="LVL1">
Tiene el objetivo que los proyectos tomen en cuenta la universalidad de las personas y considere alternativas seguras e inclusivas para todos los usuarios. <br>
                    <label>
                        <input type="radio" name="Lugar8">
                        SI
                    </label>
                    <label>
                        <input type="radio" name="Lugar8" checked>
                        NO
                    </label>
                </fieldset>
                <fieldset class="LVL2">
Tiene el objetivo que los proyectos cuenten con lotificación con orientación óptima y densidad permitida. <br>
                    <label>
                        <input type="radio" name="Lugar9">
                        SI
                    </label>
                    <label>
                        <input type="radio" name="Lugar9" checked>
                        NO
                    </label>
                </fieldset>
            </details>
            <details closed class = "Energia" data-categories="Energia">
                <summary>Energía</summary>
                <fieldset class="LVL3" data-services="E.01.1, E.01.2, E.01.3, E.01.4">
Tiene el objetivo de aprovechar al máximo lo que nos ofrece el entorno a través del diseño para disminuir el consumo energético. <br>
                   <label>
                        <input type="radio" name="Energia1">
                        SI
                    </label>
                    <label>
                        <input type="radio" name="Energia1" checked>
                        NO
                    </label>
                </fieldset>
                <fieldset class="LVL3" data-services="E.02.1">
Tiene el objetivo de generar espacios de confort aprovechando al máximo la iluminación y ventilación natural. <br>
                    <label>
                        <input type="radio" name="Energia2">
                        SI
                    </label>
                    <label>
                        <input type="radio" name="Energia2" checked>
                        NO
                    </label>
                </fieldset>
                <fieldset class="LVL3" data-services="E.03.1, E.03.2">
Tiene el objetivo de establecer acciones de mejora para los sistemas que modifican el consumo energético. <br>
                    <label>
                        <input type="radio" name="Energia3">
                        SI
                    </label>
                    <label>
                        <input type="radio" name="Energia3" checked>
                        NO
                    </label>
                </fieldset>
                <fieldset class="LVL3" data-services="E.04.1, E.04.2, E.04.3">
Tiene el objetivo de conocer el consumo de energía en el proyecto a través de un análisis de comportamiento y diseño. <br>
                    <label>
                        <input type="radio" name="Energia4">
                        SI
                    </label>
                    <label>
                        <input type="radio" name="Energia4" checked>
                        NO
                    </label>
                </fieldset>
                <fieldset class="LVL3" data-services="E.05.1">
Tiene el objetivo de conocer el consumo energético de los equipos a través de un registro mensual. <br>
                    <label>
                        <input type="radio" name="Energia5">
                        SI
                    </label>
                    <label>
                        <input type="radio" name="Energia5" checked>
                        NO
                    </label>
                </fieldset>
                <fieldset class="LVL2" data-services="E.06.1, E.06.2, E.06.3">
Tiene el objetivo de implementar tecnologías de energía renovable para disminuir o eliminar las emisiones de contaminantes a la atmósfera por la demanda eléctrica. <br>
                    <label>
                        <input type="radio" name="Energia6">
                        SI
                    </label>
                    <label>
                        <input type="radio" name="Energia6" checked>
                        NO
                    </label>
                </fieldset>
                <fieldset class="LVL1" data-services="E.07.1, E.07.2">
                    <br>
Tiene el objetivo de incentivar el uso de vehículos verdes, al proporcionar espacios exclusivos para su carga.
<br>
                    <label>
                        <input type="radio" name="Energia7">
                        SI
                    </label>
                    <label>
                        <input type="radio" name="Energia7" checked>
                        NO
                    </label>
                </fieldset>
                <fieldset class="LVL3" data-services="E.08.1">
Tiene el objetivo de reducir la carga energética a través de la conservación (usar solo lo que se necesita) y la eficiencia; y cumplir con la carga restante a través de la generación de energía renovable en el sitio.
                    <br>
                    <label>
                        <input type="radio" name="Energia8">
                        SI
                    </label>
                    <label>
                        <input type="radio" name="Energia8" checked>
                        NO
                    </label>
                </fieldset>
            </details>
            <details closed class = "Gestion" data-categories="Gestion">
                <summary>Gestion y Mantenimiento</summary>
                <fieldset class = "LVL1">
                Tiene el objetivo de conocer la situación actual y futura del proyecto de cada uno de los indicadores manejados en el sello para poder discernir los objetivos y estrategias para poder lograr un proyecto en cualquiera de sus etapas.
                    
                <br>
                <label>
                        <input type="radio" name="Gestion1">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Gestion1" checked>
                        No
                    </label>
                </fieldset>
                <fieldset class = "LVL1">
Tiene el objetivo de demostrar el correcto funcionamiento y supervisión de las acciones implementadas en el proyecto al desarrollar un plan maestro del sitio para fomentar la mantención de sus características de aporte medioambiental, económico y social en el tiempo.                    
                <br>
                <label>
                        <input type="radio" name="Gestion2">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Gestion2" checked>
                        No
                    </label>
                </fieldset>
                <fieldset class = "LVL1">
Tiene el objeo de proporcionar un sistema ordenado y eficiente para la gestión, funcionamiento y mantenimientos de las áreas y recursos involucrados en el proyecto.                    
                <br>
                <label>
                        <input type="radio" name="Gestion3">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Gestion3" checked>
                        No
                    </label>
                </fieldset>
            </details>
            <details closed class = "Educacion" data-categories="Educacion">
                <summary>Educación</summary>
                <fieldset class = "LVL2" data-services="Ed.01.1, Ed.01.2">
Tiene el objetivo de promover las competencias necesaria para cumplir con los alcances de desarrollo sostenible del proyecto.                    
                    <br>
                    <label>
                        <input type="radio" name="Educacion1">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Educacion1" checked>
                        No
                    </label>
                </fieldset>

                <fieldset class = "LVL2" data-services="Ed.02.1, Ed.02.2">
Tiene el objetivo de interactuar con la comunidad externa al proyecto para colaborar en el cumplimiento de los alcances de desarrollo sostenible del proyecto.

                    <br>
<label>
                        <input type="radio" name="Educacion2">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Educacion2" checked>
                        No
                    </label>
                </fieldset>
            </details>
        </div>
        <div class="category">
            <details closed class = "Comunidad" data-categories="Comunidad">
                <summary>Comunidad</summary>
                <fieldset class = "LVL1" data-services="C.01.1, C.01.2">
Tiene el objetivo de asegurar el acceso a alimentos nutritivos, generar un espacio para el uso de compostables y proporcionar un vínculo con la tierra.                    
                    <br>
                    <label>
                        <input type="radio" name="Comunidad1">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Comunidad1" checked>
                        No
                    </label>
                </fieldset>
                <fieldset class = "LVL1" data-services="C.02.1">
Tiene el objetivo de proporcionar alimentos nutritivos en todo momento al contar con planes de respuesta en periodos de emergencia.
                    <br>
                    <label>
                        <input type="radio" name="Comunidad2">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Comunidad2" checked>
                        No
                    </label>
                </fieldset>
                <fieldset class = "LVL1" data-services="C.03.1">
Tiene el objetivo de proporcionar a los ocupantes la oportunidad de desplazarse de una manera segura sin depender del uso de vehículos móviles, donde al mismo tiempo mejoran su salud física y mental, y no generan emisiones contaminantes a la atmósfera.                    
                    <br>
                    <label>
                        <input type="radio" name="Comunidad3">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Comunidad3" checked>
                        No
                    </label>
                </fieldset>
                <fieldset class = "LVL1" data-services="C.04.1, C.04.2">
Tiene el objetivo de proporcionar a los ocupantes la oportunidad de desplazarse de una manera segura en bicicletas donde se mejora su salud física y mental, y no generan emisiones contaminantes a la atmósfera.
                    <br>
                    <label>
                        <input type="radio" name="Comunidad4">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Comunidad4" checked>
                        No
                    </label>
                </fieldset>
                <fieldset class = "LVL1" data-services="C.05.1, C.05.2">
Tiene el objetivo de reforzar el sentido de pertenencia de los ocupantes al proporcionar espacios comunes de encuentro donde el bienestar de la comunidad es el eje principal.
                    <br>
                    <label>
                        <input type="radio" name="Comunidad5">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Comunidad5" checked>
                        No
                    </label>
                </fieldset>
                <fieldset class = "LVL1" data-services="C.06.1, C.06.2, C.06.3">
Tiene el objetivo de reforzar el sentido de pertenencia de los ocupantes al celebrar la cultura del lugar y apoyar el comercio local.
                    <br>
                    <label>
                        <input type="radio" name="Comunidad6">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Comunidad6" checked>
                        No
                    </label>
                </fieldset>
                <fieldset class = "LVL1" data-services="C.07.1">
Tiene el objetivo de generar ingresos económicos al reincorporar los residuos en el mercado, almacenando y transformando los reciclables manera segura.
                    <br>
                    <label>
                        <input type="radio" name="Comunidad7">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Comunidad7" checked>
                        No
                    </label>
                </fieldset>
                <fieldset class = "LVL1" data-services="C.08.1">
Tiene el objetivo de eliminar la generación de residuos sólidos, disminuyendo los impactos al medioambiente de los ocupantes.
                    <br>
                    <label>
                        <input type="radio" name="Comunidad8">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Comunidad8" checked>
                        No
                    </label>
                </fieldset>
                <fieldset class = "LVL1">
Promover un desarrollo urbano compacto, eficiente y bien conectado que aproveche la infraestructura existente, reduzca la dispersión urbana, fomente la movilidad sostenible y mejore la calidad de vida de los residentes, de acuerdo a normas internacionales (OMS).
                    <br>
                    <label>
                        <input type="radio" name="Comunidad9">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Comunidad9" checked>
                        No
                    </label>
                </fieldset>
            </details>
            <details closed class = "Agua" data-categories="Agua">
                <summary>Agua</summary>
                <fieldset class = "LVL1" data-services="A.01.1, A.01.2">
Tiene el objetivo de reducir el consumo de agua potable en el exterior, partiendo del consumo calculado anual y comparándolo con el año siguiente.
                    <br>
                    <label>
                        <input type="radio" name="Agua1">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Agua1" checked>
                        No
                    </label>
                </fieldset>
                <fieldset class = "LVL1" data-services="A.02.1, A.02.2, A.02.3, A.02.4">
Tiene el objetivo de reducir el consumo de agua potable en el interior, partiendo del consumo calculado anual y comparándolo con el año siguiente.
                    <br>
                    <label>
                        <input type="radio" name="Agua2">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Agua2" checked>
                        No
                    </label>
                </fieldset>
                <fieldset class = "LVL2" data-services="A.03.1, A.03.2, A.03.3">
Nos ayuda a tener conocimiento de la cantidad de agua que se consume, nos permite tener datos para poder detectar si los consumos son normales o no y así poder reducirlos.
                    <br>
                    <label>
                        <input type="radio" name="Agua3">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Agua3" checked>
                        No
                    </label>
                </fieldset>
                <fieldset class = "LVL2" data-services="A.04.1, A.04.2, A.04.3, A.04.4, A.04.5, A.04.6">
Busca cumplir con los requerimientos para poder utilizar el agua, evitar la contaminación y enfermedades para quienes la utilizan.
                    <br>
                    <label>
                        <input type="radio" name="Agua4">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Agua4" checked>
                        No
                    </label>
                </fieldset>
                <fieldset class = "LVL2" data-services="A.05.1, A.05.2, A.05.3, A.05.4, A.05.5">
Nos ayuda a buscar la posibilidad de ser autosuficientes con el consumo de agua y evitar el consumo de agua potable. Es el escenario ideal para el consumo de agua ya que generaría muchos ahorros económicos y de evitar contaminación del agua.
                    <br>
                    <label>
                        <input type="radio" name="Agua5">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Agua5" checked>
                        No
                    </label>
                </fieldset>
                <fieldset class = "LVL2" data-services="A.06.1">
Se busca reducir el impacto de la escorrentía pluvial en el sitio, promoviendo la infiltración, retención, tratamiento y reutilización del agua de lluvia. Se incentiva la implementación de estrategias que imiten los procesos hidrológicos naturales y contribuyan al ciclo sostenible del agua.
                    <br>
                    <label>
                        <input type="radio" name="Agua6">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Agua6" checked>
                        No
                    </label>
                </fieldset>
            </details>
            <details closed class = "Salud" data-categories="Salud">
                <summary>Salud y Felicidad</summary>
                <fieldset class = "LVL2" data-services="S.01.1, S.01.2, S.01.3">
Tiene el objetivo de contribuir al confort y bienestar de todos los ocupantes estableciendo normas mínimas de calidad del aire interior (CAI).
<br>                    
<label>
                        <input type="radio" name="Salud1">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Salud1" checked>
                        No
                    </label>
                </fieldset>
                <fieldset class = "LVL2" data-services="S.02.1, S.02.2">
                Tiene como objetivo evitar la presencia de humo de tabaco, vape y cannabis en espacios públicos y dentro de los establecimientos.   
                <br>
                <label>                  
                <input type="radio" name="Salud2">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Salud2" checked>
                        No
                    </label>
                </fieldset>
                <fieldset class = "LVL2" data-services="S.03.1">
                Tiene como objetivo reducir el uso de iluminación eléctrica mediante la introducción de luz natural en el espacio.

                <br>
                <label>
                <input type="radio" name="Salud3">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Salud3" checked>
                        No
                    </label>
                </fieldset>
                <fieldset class = "LVL2" data-services="S.04.1, S.04.2">
                Tiene como objetivo proporcionar a los ocupantes del edificio una conexión con el entorno natural exterior mediante vistas de calidad.                
                <br>
                <label>
                    <input type="radio" name="Salud4">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Salud4" checked>
                        No
                    </label>
                </fieldset>
                <fieldset class = "LVL2" data-services="S.05.1, S.05.2">
Tiene el objetivo de apoyar y mejorar la salud, el bienestar y la productividad de las personas proporcionando e incorporando elementos de la naturaleza en el ambiente interior.
<br>                
<label>
                    <input type="radio" name="Salud5">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Salud5" checked>
                        No
                    </label>
                </fieldset>
                <fieldset class = "LVL2" data-services="S.06.1, S.06.2">
Tiene como objetivo que los ocupantes del edificio tengan acceso a espacios verdes y vistas hacia la naturaleza que los rodea para mejorar la comodidad y la eficiencia de las actividades.                
<br>
<label>
                    <input type="radio" name="Salud6">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Salud6" checked>
                        No
                    </label>
                </fieldset>

                <fieldset class = "LVL1" data-services="S.07.1, S.07.2, S.07.3">
Tiene como objetivo brindar espacios de recreación para los ocupantes del edificio y que puedan tener alternativas de actividades en tiempos libres.
<br>
<label>
                    <input type="radio" name="Salud7">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Salud7" checked>
                        No
                    </label>
                </fieldset>

                <fieldset class = "LVL2" data-services="S.08.1, S.08.2, S.08.3">
Tiene como objetivo brindar espacios de recreación para los ocupantes del edificio y que puedan tener alternativas de actividades en tiempos libres.
<br>
<label>
                    <input type="radio" name="Salud8">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Salud8" checked>
                        No
                    </label>
                </fieldset>

            </details>
            <details closed class = "Materiales" data-categories="Materiales">
                <summary>Materiales y Construccion amigables</summary>
                <fieldset class = "LVL1" data-services="M.01.1">
Tiene el objetivo de reducir las concentraciones de productos químicos contaminantes que puedan dañar la calidad del aire, la salud humana y el medio ambiente.
<br>
                    <label>
                        <input type="radio" name="Materiales1">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Materiales1" checked>
                        No
                    </label>
                </fieldset>

                <fieldset class = "LVL1" data-services="M.02.1">
Tiene el objetivo de utilizar la mayor cantidad de materiales responsables y disminuir la cantidad de materiales convencionales utilizados para la construcción.
<br>                    
<label>
                        <input type="radio" name="Materiales2">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Materiales2" checked>
                        No
                    </label>
                </fieldset>

                <fieldset class = "LVL2" data-services="M.03.1, M.03.2">
Se presentan una serie de medidas que pretenden disminuir los efectos contaminantes de la obra hacia el ambiente (suelo, aire y agua), así como hacia las personas (trabajadores, contratistas, habitantes y otros).
                    <br>
                    <label>
                        <input type="radio" name="Materiales3">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Materiales3" checked>
                        No
                    </label>
                </fieldset>

                <fieldset class = "LVL2" data-services="M.04.1, M.04.2">
Tiene el objetivo de promover que los residuos generados por la construcción vayan destinados a los centros de recolección de residuos, así como promover la reducción de la generación de los mismos usando materiales prefabricados.                    
<br>                    
<label>
                        <input type="radio" name="Materiales4">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Materiales4" checked>
                        No
                    </label>
                </fieldset>

                <fieldset class = "LVL2" data-services="M.05.1, M.05.2">
Tiene el objetivo de promover que los sistemas y equipos utilizados en el proyecto estén comisionados. Lo que significa que han sido diseñados, instalados y que funcionan de acuerdo con los requisitos de construcción y los mínimos de normas, códigos o reglamentos aplicables.                    
<br>                    
<label>
                        <input type="radio" name="Materiales5">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Materiales5" checked>
                        No
                    </label>
                </fieldset>

                <fieldset class = "LVL1" data-services="M.06.1">
Objetivo favorecer las condiciones socio-ambientales de la región comprando a proveedores que tengan una ventaja competitiva (social y ambiental) frente a otras opciones de proveedores.
<br>
                    <label>
                        <input type="radio" name="Materiales6">
                        Si
                    </label>
                    <label>
                        <input type="radio" name="Materiales6" checked>
                        No
                    </label>
                </fieldset>



                
            </details>
            
            
        </div>
    </div>
</body>
 </div> <div id="resultado-cotizacion"></div>
<script>document.addEventListener('DOMContentLoaded', () => {

    const ajaxUrl = typeof diagnostic_ajax !== 'undefined' ? diagnostic_ajax.ajax_url : '/wp-admin/admin-ajax.php';
    const nonce = typeof diagnostic_ajax !== 'undefined' ? diagnostic_ajax.nonce : '';

    function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return decodeURIComponent(parts.pop().split(';').shift());
        return null;
    }

    const nonceField = document.getElementById('nonce-field');
    if (nonceField) {
        nonceField.value = nonce;
    }

    const serviceCost = {"LVL1": 1, "LVL2": 2, "LVL3": 4};
    const allFieldsets = document.querySelectorAll('.categories details fieldset');
    const selectedHistory = {};

    const TOTAL_COMPONENTS = 49;
    const MONTHLY_COST = 12000;

    const params = new URLSearchParams(window.location.search);
    const categoriasParam = params.get('categorias');
    const selectionParam = params.get('servicios');
    const categoriasSeleccionadas = categoriasParam ? categoriasParam.split(" ") : [];

    function applySelectionFromURL()
    {
        if (!selectionParam) return;
        const selectedNames = selectionParam.split("_");

        selectedNames.forEach(name => {
                const radios = document.querySelectorAll(`input[type="radio"][name="${name}"]`);
                if (radios.length >= 2) {
                    const siRadio = radios[0]; // Asumimos que SI es el primero
                    const noRadio = radios[1]; // Asumimos que NO es el segundo
                    if (siRadio && noRadio && siRadio.nextSibling.textContent.trim().toLowerCase() === 'si') {
                        siRadio.checked = true;
                        noRadio.checked = false;
                    }
                }
            });
    }
    

    const categoriesContainer = document.querySelector('.categories');
    if (categoriesContainer) {
        categoriesContainer.querySelectorAll('.category details').forEach(detail => {
            const categoria = detail.getAttribute('data-categories');
            detail.style.display = categoriasSeleccionadas.length === 0 || categoriasSeleccionadas.includes(categoria)
                ? ''
                : 'none';
        });

        // Oculta columnas vacías
        categoriesContainer.querySelectorAll('.category').forEach(cat => {
            const visible = Array.from(cat.querySelectorAll('details')).some(d => d.style.display !== 'none');
            cat.style.display = visible ? '' : 'none';
            if (visible) cat.style.flex = '';
        });

        const visibles = categoriesContainer.querySelectorAll('.category:not([style*="display: none"])');
        if (visibles.length === 1) {
            visibles[0].style.flex = '1 1 100%';
        }
    }

    function getSelectedServices() {
        for (const k in selectedHistory) delete selectedHistory[k];

        allFieldsets.forEach(fieldset => {
            const firstRadio = fieldset.querySelector('input[type="radio"]');
            if (!firstRadio) return;

            const preguntaId = firstRadio.name;
            const selected = fieldset.querySelector(`input[type="radio"][name="${preguntaId}"]:checked`);
            if (!selected) return;

            const respuestaTxt = (selected.nextSibling?.textContent || selected.value || '').trim().toLowerCase();
            if (respuestaTxt === 'no') return;

            const categoria = fieldset.closest('details')?.querySelector('summary')?.textContent?.trim() || 'Sin categoría';
            const nivel = fieldset.className.trim();

            // Obtén descripción: atributo data-title o texto antes del primer label
            let titulo = fieldset.getAttribute('data-title');
            if (!titulo) {
                const fragments = [];
                for (const node of fieldset.childNodes) {
                    if (node.nodeType === 1 && node.tagName === 'LABEL') break;
                    if (node.nodeType === 1 && node.tagName === 'P') fragments.push(node.textContent.trim());
                    else if (node.nodeType === 3) {
                        const t = node.textContent.replace(/\s+/g,' ').trim();
                        if (t) fragments.push(t);
                    }
                }
                titulo = fragments.join(' ').trim();
            }

            const attr = fieldset.getAttribute('data-services');
            const serviceCodes = attr
                ? attr.split(/[,;]+/).map(s => s.trim()).filter(Boolean)
                : [preguntaId];

            serviceCodes.forEach(code => {
                selectedHistory[code] = {
                    codigo: code,
                    pregunta: preguntaId,
                    categoria,
                    nivel,
                    titulo,
                    respuesta: 'Sí',
                    costo: serviceCost[nivel] || 1
                };
            });
        });

        return Object.values(selectedHistory);
    }

    function distributeServicesByMonth(services, maxCostPerMonth = 4) {
        const months = [];
        let currentMonth = [];
        let currentCost = 0;
        services.forEach(service => {
            if (currentCost + service.costo > maxCostPerMonth) {
                months.push(currentMonth);
                currentMonth = [];
                currentCost = 0;
            }
            currentMonth.push(service);
            currentCost += service.costo;
        });
        if (currentMonth.length) months.push(currentMonth);
        return months;
    }

    // Reemplaza la función anterior por esta
    function distributeServicesByMonthPriority(services, maxCostPerMonth = 4, priority = ['LVL1','LVL2','LVL3']) {
        const months = [];

        function placeService(s){
            for (let m = 0; m < months.length; m++){
                if ((months[m].costUsed + s.costo) <= maxCostPerMonth){
                    months[m].services.push(s);
                    months[m].costUsed += s.costo;
                    return;
                }
            }
            // Crear nuevo mes
            months.push({ costUsed: s.costo, services:[s] });
        }

        priority.forEach(level => {
            services.filter(s => s.nivel === level)
                    .forEach(s => placeService(s));
        });

        // Devolver solo arrays de servicios por mes
        return months.map(m => m.services);
    }

    function renderTable(months) {
        document.querySelectorAll('.plan-output').forEach(n => n.remove());

        if (!document.getElementById('planStyles')) {
            const st = document.createElement('style');
            st.id = 'planStyles';
            st.textContent = `
            .plan-output { margin-top:24px; font-family:Arial, sans-serif; }
            .deliverables-table { width:100%; border-collapse:collapse; font-size:12px; }
            .deliverables-table th, .deliverables-table td { border:1px solid #d0d4dc; vertical-align:top; padding:8px 10px; }
            .deliverables-table th { background:#143e7c; color:#fff; font-weight:600; text-align:center; }
            .deliverables-table td.nivel-col { width:70px; font-weight:600; background:#f2f5f8; }
            .deliverables-table td.componentes-col { width:260px; background:#f8f9fb; }
            .deliverables-table ul { list-style:none; margin:0; padding:0; }
            .deliverables-table li::before { content:"* "; color:#143e7c; font-weight:600; }
            .nivel-tag-LVL1 { color:#143e7c; }
            .nivel-tag-LVL2 { color:#8a4d00; }
            .nivel-tag-LVL3 { color:#5a2c91; }
            .plan-notes{
            margin-top:18px;
                background:linear-gradient(135deg,#f0f8f3 0%, #e3f5e8 100%);
                border:1px solid #c6e7d2;
                padding:18px 22px;
                border-radius:14px;
                color:#1f4d2b;
                font-size:13px;
                line-height:1.55;
                box-shadow:0 2px 4px rgba(0,0,0,.04);
                position:relative;
                overflow:hidden;
            }
                .plan-notes::after {
                content:"";
                position:absolute;
                width:160px;
                height:160px;
                right:-40px;
                top:-40px;
                background:radial-gradient(circle at 30% 30%, rgba(109,207,143,.35), rgba(49,168,97,0));
                transform:rotate(25deg);
                pointer-events:none;
            }
            .plan-notes-title {
                font-weight:600;
                font-size:14px;
                text-transform:uppercase;
                letter-spacing:.5px;
                margin-bottom:10px;
                display:flex;
                align-items:center;
                gap:8px;
                color:#1d5e34;
            }
            .plan-notes-title::before {
                content:"🌿";
                font-size:18px;
            }
            .plan-notes ul {
                list-style:none;
                margin:0;
                padding:0;
            }
            .plan-notes li {
                position:relative;
                margin:6px 0 8px;
                padding-left:22px;
            }
            .plan-notes li::before {
                content:"";
                position:absolute;
                left:0;
                top:6px;
                width:12px;
                height:12px;
                background:radial-gradient(circle at 30% 30%, #6dcf8f, #31a861);
                border-radius:3px;
                transform:rotate(45deg);
                box-shadow:0 0 0 2px #f0f8f3;
            }
            .plan-notes a {
                color:#247a45;
                text-decoration:underline;
            }
            .plan-notes a:hover {
                text-decoration:none;
            }
            .plan-total {
                margin: 24px 0 18px;
                padding: 16px 22px;
                background: #fff;
                border: 1px solid #7a8a76;
                border-left: 6px solid #385898;
                border-radius: 12px;
                text-align: center;
                font-size: 16px;
                color: #5d6b5a;
                box-shadow: 0 3px 8px -3px rgba(0,0,0,.1);
            }
            .plan-total-label {
                font-weight: 600;
                color: #385898;
                display: block;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: .5px;
                margin-bottom: 4px;
            }
            .plan-total-value {
                font-size: 22px;
                font-weight: 700;
                color: #385898;
                margin-right: 10px;
            }
            .plan-total-details {
                font-size: 14px;
                color: #7a8a76;
                display: block;
                margin-top: 4px;
            }
            #sendEmailButton {
                margin-top: 12px;
                padding: 12px 24px;
                background-color: #143e7c;
                color: #fff;
                border: none;
                border-radius: 8px;
                font-size: 14px;
                cursor: pointer;
                transition: background-color 0.3s ease;
                display: block;
                margin-left: auto;
                margin-right: auto;
            }
            
            `
            ;
            document.head.appendChild(st);
        }

        // Agrupa servicios seleccionados totales por nivel
        const levelMap = {};
        const nivelOrder = ['LVL1','LVL2','LVL3'];
        const allServices = months.flat(); // ya ordenados antes por updateResults

        allServices.forEach(s => {
            if (!levelMap[s.nivel]) levelMap[s.nivel] = { all: [], months: [] };
            levelMap[s.nivel].all.push(s);
        });

        // Inicializa matriz months por nivel
        months.forEach((monthServices, mIdx) => {
            nivelOrder.forEach(nv => {
                if (!levelMap[nv]) levelMap[nv] = { all: [], months: [] };
                if (!levelMap[nv].months[mIdx]) levelMap[nv].months[mIdx] = [];
            });
            monthServices.forEach(s => {
                levelMap[s.nivel].months[mIdx].push(s);
            });
        });

        const container = document.createElement('div');
        container.className = 'plan-output';

        const table = document.createElement('table');
        table.className = 'deliverables-table';

        // Header
        const thead = document.createElement('thead');
        const htr = document.createElement('tr');
        htr.innerHTML = `
            <th>Nivel</th>
            <th>Componentes seleccionados por el cliente para su proyecto</th>
            ${months.map((_,i)=>`<th>Entregas Mes ${i+1}</th>`).join('')}
        `;
        thead.appendChild(htr);
        table.appendChild(thead);

        // Body
        const tbody = document.createElement('tbody');

        nivelOrder.forEach(nv => {
            const data = levelMap[nv];
            if (!data) return; // si no hay ninguno
            if (data.all.length === 0 && months.length === 0) return;

            const tr = document.createElement('tr');

            const nivelCell = document.createElement('td');
            nivelCell.className = 'nivel-col';
            nivelCell.textContent = 'Nivel ' + nv.replace('LVL','');
            tr.appendChild(nivelCell);

            const compCell = document.createElement('td');
            compCell.className = 'componentes-col';
            const listAll = document.createElement('ul');
            data.all.forEach(s => {
                const li = document.createElement('li');
                // Texto: código - título (si existe)
                li.textContent = `${s.codigo}${s.titulo ? ' - ' + s.titulo : ''}`;
                listAll.appendChild(li);
            });
            compCell.appendChild(listAll);
            tr.appendChild(compCell);

            // Meses
            months.forEach((_, idx) => {
                const mCell = document.createElement('td');
                const arr = (data.months[idx] || []);
                if (arr.length) {
                    const ul = document.createElement('ul');
                    arr.forEach(s => {
                        const li = document.createElement('li');
                        li.textContent = `${s.codigo}${s.titulo ? ' - ' + s.titulo : ''}`;
                        ul.appendChild(li);
                    });
                    mCell.appendChild(ul);
                }
                tr.appendChild(mCell);
            });

            tbody.appendChild(tr);
        });

        table.appendChild(tbody);
        container.appendChild(table);
        

        const selectedCount = allServices.length;
        const monthsCount = months.length;
        const totalCost = monthsCount * MONTHLY_COST;
        const notes = document.createElement('div');
        const totalDiv = document.createElement('div');
        totalDiv.className = 'plan-total';
        totalDiv.innerHTML = `
            <span class="plan-total-label">Costo total del proyecto:</span>
            <span class="plan-total-value">${new Intl.NumberFormat('es-MX', { style: 'currency', currency: 'MXN' }).format(totalCost)} MXN + IVA</span>
            <span class="plan-total-details">(${monthsCount} ${monthsCount === 1 ? 'mes' : 'meses'} de trabajo por ${new Intl.NumberFormat('es-MX', { style: 'currency', currency: 'MXN' }).format(MONTHLY_COST)} / mensuales)</span>
        `;
        notes.className = 'plan-notes';
        notes.innerHTML = `
            <div class="plan-notes-title">NOTAS:</div>
            <ul>
                <li>El cliente eligió ${selectedCount} componentes de ${TOTAL_COMPONENTS} totales que tiene la metodología Bansani.</li>
                <li>Los entregables van en función de los niveles: Nivel 1 (4 componentes/mes), Nivel 2 (2 componentes/mes), Nivel 3 (1 componente/mes).</li>
                <li>Tendrás un equipo de expertos en sostenibilidad enfocados en tu proyecto.</li>
            </ul>
        `;
        const sendButton = document.createElement('button');
        sendButton.id = 'sendEmailButton';
        sendButton.textContent = 'Enviar cotización';

        if (selectedCount > 0) {
            document.getElementById('resultado-cotizacion').appendChild(container);
            container.appendChild(totalDiv);
            container.appendChild(notes);
            container.appendChild(sendButton);
        }
    }

    function updateResults(services = []) {
        document.querySelectorAll('.plan-output').forEach(n => n.remove());

        // Orden base por prioridad (LVL1 primero)
        const orderWeight = { LVL1: 0, LVL2: 1, LVL3: 2 };
        services.sort((a, b) => orderWeight[a.nivel] - orderWeight[b.nivel]);

        // Nueva distribución que respeta prioridad nivel
        const months = distributeServicesByMonthPriority(services, 4, ['LVL1','LVL2','LVL3']);
        renderTable(months);
    }
    function generateShareLink() {
        const selectedServices = getSelectedServices();
        const questionNames = selectedServices.map(s => s.pregunta).filter((v, i, a) => a.indexOf(v) === i);
        if (questionNames.length === 0) {
                return;
            }
            const selectionString = questionNames.join('_');
            console.log('Cadena de selección para URL:', selectionString);
            const url = new URL(window.location);
            url.searchParams.set('servicios', selectionString);
            window.history.pushState({}, '', url);
    }

    

    function refresh() {
        const services = getSelectedServices();
        generateShareLink();
        updateResults(services);
    }

    allFieldsets.forEach(fieldset => {
        fieldset.querySelectorAll('input[type="radio"]').forEach(radio => {
            radio.addEventListener('change', refresh);
        });
    });
    function openModal()
    {
        const m = document.getElementById('client-modal');
        if (!m) return;
        m.setAttribute('aria-hidden', 'false');
        m.style.display = 'block';
        const f = m.querySelector('form');
        if (f){
            f.reset();
            f.focus();
        }
    }

    function closeModal()
    {
        const m = document.getElementById('client-modal');
        if (!m) return;
        m.setAttribute('aria-hidden', 'true');
        m.style.display = 'none';
    }
    
        document.addEventListener('click', function(e) {
        const btn = e.target.closest && e.target.closest('#sendEmailButton');
        if (btn) {
        e.preventDefault();
        const clientInfoCookie = getCookie('client_info_json');
        if (clientInfoCookie) {
            const services = window.location.href;
console.log('HOLA');
console.log(clientInfoCookie);

            const formData = new FormData();
            formData.append('action', 'send_clientify_contact');
            formData.append('nonce', nonce);           
            formData.append('client_info_json', clientInfoCookie);
            formData.append('services', services);
            fetch(ajaxUrl, {
                    method: 'POST',
                    body: formData,
                    credentials: 'same-origin'
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`Network response was not ok: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    if (data.success) 
                    {
                        window.location.href = 'https://dev.bnzero.com/bansani/gracias/';
                    } else {
                        const errorMsg = data.data && data.data.message ? data.data.message : 'Error desconocido';
                        console.error('Error al enviar la cotización:', errorMsg);
            
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Hubo un error al enviar la cotización. Por favor, inténtalo de nuevo.');
                });
        }
        else
        {
            openModal();
        }
        //get id close-modal-btn
        if (e.target.closest && e.target.closest('#close-modal-btn')){
            e.preventDefault();
            closeModal();
            return;
        }

        }
        });

        const modal = document.getElementById('client-modal');
        if (modal) 
        {
            modal.addEventListener('click', function(e){
                if (e.target === modal) closeModal();
            });
        }

        document.addEventListener('keydown', function(e){
            if (e.key === 'Escape'){
                const m = document.getElementById('client-modal');
                if (m && m.getAttribute('aria-hidden') === 'false'){
                    closeModal();
                }
            }
        });
        // Envía el formulario por AJAX
        const form = document.getElementById('client-form');
        if(form)
        {
            form.addEventListener('submit', function(e){
                e.preventDefault();
                const clientDataForCookie = 
                {
                    nombre: form.querySelector('input[name="nombre"]')?.value || '',
                    correo: form.querySelector('input[name="correo"]')?.value || '',
                    telefono: form.querySelector('input[name="telefono"]')?.value || ''
                };
                console.log('Datos del cliente para la cookie:', clientDataForCookie);
                document.cookie = "client_info_json=" + encodeURIComponent(JSON.stringify(clientDataForCookie)) + "; path=/";
                const formData = new FormData(form);
                //get selected services url to save params
                const services = window.location.href;
                formData.append('action', 'send_clientify_contact');
                formData.append('nonce', nonce);  
                formData.append('services', services);
                console.log('Servicios seleccionados:', getSelectedServices());
                const submitButton = form.querySelector('button[type="submit"]');

                if (submitButton) {
                    submitButton.textContent = 'Enviando...';
                    submitButton.disabled = true;
                }

                fetch(ajaxUrl, {
                    method: 'POST',
                    body: formData,
                    credentials: 'same-origin'
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`Network response was not ok: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    if (data.success) 
                    {
                        window.location.href = 'https://dev.bnzero.com/bansani/gracias/';
                    } else {
                        const errorMsg = data.data && data.data.message ? data.data.message : 'Error desconocido';
                        console.error('Error al enviar la cotización:', errorMsg);
                        if (submitButton) {
                            submitButton.textContent = 'Enviar Cotización';
                            submitButton.disabled = false;
                        }
            
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Hubo un error al enviar la cotización. Por favor, inténtalo de nuevo.');
                    if (submitButton) {
                        submitButton.textContent = 'Enviar Cotización';
                        submitButton.disabled = false;
                    }
                });
            });
        }

    // Init
    applySelectionFromURL();
    refresh();
});
</script>
</html>